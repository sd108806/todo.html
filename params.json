{"name":"Todo.html","tagline":"","body":"var html5rocks = {};\r\nhtml5rocks.webdb = {};\r\nhtml5rocks.webdb.db = null;\r\n\r\nhtml5rocks.webdb.open = function() {\r\n  var dbSize = 5 * 1024 * 1024; // 5MB\r\n  html5rocks.webdb.db = openDatabase(\"Todo\", \"1.0\", \"Todo manager\", dbSize);\r\n}\r\n\r\nhtml5rocks.webdb.createTable = function() {\r\n  var db = html5rocks.webdb.db;\r\n  db.transaction(function(tx) {\r\n    tx.executeSql(\"CREATE TABLE IF NOT EXISTS todo(ID INTEGER PRIMARY KEY ASC, todo TEXT, added_on DATETIME)\", []);\r\n  });\r\n}\r\n\r\nhtml5rocks.webdb.addTodo = function(todoText) {\r\n  var db = html5rocks.webdb.db;\r\n  db.transaction(function(tx){\r\n    var addedOn = new Date();\r\n    tx.executeSql(\"INSERT INTO todo(todo, added_on) VALUES (?,?)\",\r\n        [todoText, addedOn],\r\n        html5rocks.webdb.onSuccess,\r\n        html5rocks.webdb.onError);\r\n   });\r\n}\r\n\r\nhtml5rocks.webdb.onError = function(tx, e) {\r\n  alert(\"There has been an error: \" + e.message);\r\n}\r\n\r\nhtml5rocks.webdb.onSuccess = function(tx, r) {\r\n  // re-render the data.\r\n  html5rocks.webdb.getAllTodoItems(loadTodoItems);\r\n}\r\n\r\n\r\nhtml5rocks.webdb.getAllTodoItems = function(renderFunc) {\r\n  var db = html5rocks.webdb.db;\r\n  db.transaction(function(tx) {\r\n    tx.executeSql(\"SELECT * FROM todo\", [], renderFunc,\r\n        html5rocks.webdb.onError);\r\n  });\r\n}\r\n\r\nhtml5rocks.webdb.deleteTodo = function(id) {\r\n  var db = html5rocks.webdb.db;\r\n  db.transaction(function(tx){\r\n    tx.executeSql(\"DELETE FROM todo WHERE ID=?\", [id],\r\n        html5rocks.webdb.onSuccess,\r\n        html5rocks.webdb.onError);\r\n    });\r\n}\r\n\r\nfunction loadTodoItems(tx, rs) {\r\n  var rowOutput = \"\";\r\n  var todoItems = document.getElementById(\"todoItems\");\r\n  for (var i=0; i < rs.rows.length; i++) {\r\n    rowOutput += renderTodo(rs.rows.item(i));\r\n  }\r\n\r\n  todoItems.innerHTML = rowOutput;\r\n}\r\n\r\nfunction renderTodo(row) {\r\n  return \"<li>\" + row.todo  + \" [<a href='javascript:void(0);'  onclick='html5rocks.webdb.deleteTodo(\" + row.ID +\");'>Delete</a>]</li>\";\r\n}\r\n\r\nfunction init() {\r\n  html5rocks.webdb.open();\r\n  html5rocks.webdb.createTable();\r\n  html5rocks.webdb.getAllTodoItems(loadTodoItems);\r\n}\r\n\r\nfunction addTodo() {\r\n  var todo = document.getElementById(\"todo\");\r\n  html5rocks.webdb.addTodo(todo.value);\r\n  todo.value = \"\";\r\n}â€‹\r\n  ","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}